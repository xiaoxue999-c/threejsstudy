{"id":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","dependencies":[{"name":"C:\\Users\\ADMINWWQ\\Desktop\\threejs\\01-three_basic\\package.json","includedInParent":true,"mtime":1713938217714},{"name":"C:\\Users\\ADMINWWQ\\Desktop\\threejs\\01-three_basic\\node_modules\\three\\package.json","includedInParent":true,"mtime":1713854592536},{"name":"three","loc":{"line":16,"column":41,"index":548},"parent":"C:\\Users\\ADMINWWQ\\Desktop\\threejs\\01-three_basic\\node_modules\\three\\examples\\jsm\\shaders\\MMDToonShader.js","resolved":"C:\\Users\\ADMINWWQ\\Desktop\\threejs\\01-three_basic\\node_modules\\three\\build\\three.module.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MMDToonShader = void 0;\nvar _three = require(\"three\");\n/**\n * MMD Toon Shader\n *\n * This shader is extended from MeshPhongMaterial, and merged algorithms with\n * MeshToonMaterial and MeshMetcapMaterial.\n * Ideas came from https://github.com/mrdoob/three.js/issues/19609\n *\n * Combining steps:\n *  * Declare matcap uniform.\n *  * Add gradientmap_pars_fragment.\n *  * Use gradient irradiances instead of dotNL irradiance from MeshPhongMaterial.\n *    (Replace lights_phong_pars_fragment with lights_mmd_toon_pars_fragment)\n *  * Add mmd_toon_matcap_fragment.\n */\n\nvar lights_mmd_toon_pars_fragment = /* glsl */\"\\nvarying vec3 vViewPosition;\\n\\nstruct BlinnPhongMaterial {\\n\\n\\tvec3 diffuseColor;\\n\\tvec3 specularColor;\\n\\tfloat specularShininess;\\n\\tfloat specularStrength;\\n\\n};\\n\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\n\\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\\n\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n\\n\\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\\n\\n}\\n\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\\n\\n}\\n\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n\";\nvar mmd_toon_matcap_fragment = /* glsl */\"\\n#ifdef USE_MATCAP\\n\\n\\tvec3 viewDir = normalize( vViewPosition );\\n\\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\\n\\tvec3 y = cross( viewDir, x );\\n\\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\\n\\tvec4 matcapColor = texture2D( matcap, uv );\\n\\n\\t#ifdef MATCAP_BLENDING_MULTIPLY\\n\\n\\t\\toutgoingLight *= matcapColor.rgb;\\n\\n\\t#elif defined( MATCAP_BLENDING_ADD )\\n\\n\\t\\toutgoingLight += matcapColor.rgb;\\n\\n\\t#endif\\n\\n#endif\\n\";\nvar MMDToonShader = exports.MMDToonShader = {\n  name: 'MMDToonShader',\n  defines: {\n    TOON: true,\n    MATCAP: true,\n    MATCAP_BLENDING_ADD: true\n  },\n  uniforms: _three.UniformsUtils.merge([_three.ShaderLib.toon.uniforms, _three.ShaderLib.phong.uniforms, _three.ShaderLib.matcap.uniforms]),\n  vertexShader: _three.ShaderLib.phong.vertexShader.replace('#include <envmap_pars_vertex>', '').replace('#include <envmap_vertex>', ''),\n  fragmentShader: _three.ShaderLib.phong.fragmentShader.replace('#include <common>', \"\\n\\t\\t\\t\\t\\t#ifdef USE_MATCAP\\n\\t\\t\\t\\t\\t\\tuniform sampler2D matcap;\\n\\t\\t\\t\\t\\t#endif\\n\\n\\t\\t\\t\\t\\t#include <common>\\n\\t\\t\\t\\t\").replace('#include <envmap_common_pars_fragment>', \"\\n\\t\\t\\t\\t\\t#include <gradientmap_pars_fragment>\\n\\t\\t\\t\\t\").replace('#include <envmap_pars_fragment>', '').replace('#include <lights_phong_pars_fragment>', lights_mmd_toon_pars_fragment).replace('#include <envmap_fragment>', \"\\n\\t\\t\\t\\t\\t\".concat(mmd_toon_matcap_fragment, \"\\n\\t\\t\\t\\t\"))\n};"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":7,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":16,"column":0}},{"generated":{"line":7,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":16,"column":0},"name":"_three"},{"generated":{"line":7,"column":10},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":16,"column":0}},{"generated":{"line":7,"column":13},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":16,"column":0},"name":"require"},{"generated":{"line":7,"column":20},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":16,"column":0}},{"generated":{"line":8,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":1,"column":0}},{"generated":{"line":9,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":2,"column":0}},{"generated":{"line":10,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":3,"column":0}},{"generated":{"line":11,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":4,"column":0}},{"generated":{"line":12,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":5,"column":0}},{"generated":{"line":13,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":6,"column":0}},{"generated":{"line":14,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":7,"column":0}},{"generated":{"line":15,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":8,"column":0}},{"generated":{"line":16,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":9,"column":0}},{"generated":{"line":17,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":10,"column":0}},{"generated":{"line":18,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":11,"column":0}},{"generated":{"line":19,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":12,"column":0}},{"generated":{"line":20,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":13,"column":0}},{"generated":{"line":21,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":14,"column":0}},{"generated":{"line":23,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":18,"column":0}},{"generated":{"line":23,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":18,"column":6},"name":"lights_mmd_toon_pars_fragment"},{"generated":{"line":23,"column":33},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":18,"column":35}},{"generated":{"line":23,"column":36},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":18,"column":38}},{"generated":{"line":23,"column":1382},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":48,"column":1}},{"generated":{"line":24,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":50,"column":0}},{"generated":{"line":24,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":50,"column":6},"name":"mmd_toon_matcap_fragment"},{"generated":{"line":24,"column":28},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":50,"column":30}},{"generated":{"line":24,"column":31},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":50,"column":33}},{"generated":{"line":24,"column":571},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":70,"column":1}},{"generated":{"line":25,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":0}},{"generated":{"line":25,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":6},"name":"MMDToonShader"},{"generated":{"line":25,"column":17},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":19}},{"generated":{"line":25,"column":20},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":19},"name":"exports"},{"generated":{"line":25,"column":27},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":19}},{"generated":{"line":25,"column":28},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":19},"name":"MMDToonShader"},{"generated":{"line":25,"column":41},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":19}},{"generated":{"line":25,"column":44},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":72,"column":22}},{"generated":{"line":26,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":74,"column":1},"name":"name"},{"generated":{"line":26,"column":6},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":74,"column":5}},{"generated":{"line":26,"column":8},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":74,"column":7}},{"generated":{"line":26,"column":23},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":74,"column":22}},{"generated":{"line":27,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":76,"column":1},"name":"defines"},{"generated":{"line":27,"column":9},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":76,"column":8}},{"generated":{"line":27,"column":11},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":76,"column":10}},{"generated":{"line":28,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":77,"column":2},"name":"TOON"},{"generated":{"line":28,"column":8},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":77,"column":6}},{"generated":{"line":28,"column":10},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":77,"column":8}},{"generated":{"line":28,"column":14},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":77,"column":12}},{"generated":{"line":29,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":78,"column":2},"name":"MATCAP"},{"generated":{"line":29,"column":10},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":78,"column":8}},{"generated":{"line":29,"column":12},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":78,"column":10}},{"generated":{"line":29,"column":16},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":78,"column":14}},{"generated":{"line":30,"column":4},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":79,"column":2},"name":"MATCAP_BLENDING_ADD"},{"generated":{"line":30,"column":23},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":79,"column":21}},{"generated":{"line":30,"column":25},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":79,"column":23}},{"generated":{"line":31,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":80,"column":1}},{"generated":{"line":31,"column":3},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":80,"column":2}},{"generated":{"line":32,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":1},"name":"uniforms"},{"generated":{"line":32,"column":10},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":9}},{"generated":{"line":32,"column":12},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":11},"name":"UniformsUtils"},{"generated":{"line":32,"column":32},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":24}},{"generated":{"line":32,"column":33},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":25},"name":"merge"},{"generated":{"line":32,"column":38},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":30}},{"generated":{"line":32,"column":39},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":82,"column":32}},{"generated":{"line":32,"column":40},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":2},"name":"ShaderLib"},{"generated":{"line":32,"column":56},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":11}},{"generated":{"line":32,"column":57},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":12},"name":"toon"},{"generated":{"line":32,"column":61},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":16}},{"generated":{"line":32,"column":62},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":17},"name":"uniforms"},{"generated":{"line":32,"column":70},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":83,"column":25}},{"generated":{"line":32,"column":72},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":2},"name":"ShaderLib"},{"generated":{"line":32,"column":88},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":11}},{"generated":{"line":32,"column":89},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":12},"name":"phong"},{"generated":{"line":32,"column":94},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":17}},{"generated":{"line":32,"column":95},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":18},"name":"uniforms"},{"generated":{"line":32,"column":103},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":84,"column":26}},{"generated":{"line":32,"column":105},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":2},"name":"ShaderLib"},{"generated":{"line":32,"column":121},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":11}},{"generated":{"line":32,"column":122},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":12},"name":"matcap"},{"generated":{"line":32,"column":128},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":18}},{"generated":{"line":32,"column":129},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":19},"name":"uniforms"},{"generated":{"line":32,"column":137},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":85,"column":27}},{"generated":{"line":32,"column":138},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":86,"column":3}},{"generated":{"line":32,"column":139},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":86,"column":4}},{"generated":{"line":33,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":88,"column":1},"name":"vertexShader"},{"generated":{"line":33,"column":14},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":88,"column":13}},{"generated":{"line":33,"column":16},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":2},"name":"ShaderLib"},{"generated":{"line":33,"column":32},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":11}},{"generated":{"line":33,"column":33},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":12},"name":"phong"},{"generated":{"line":33,"column":38},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":17}},{"generated":{"line":33,"column":39},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":18},"name":"vertexShader"},{"generated":{"line":33,"column":51},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":89,"column":30}},{"generated":{"line":33,"column":52},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":90,"column":4},"name":"replace"},{"generated":{"line":33,"column":59},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":90,"column":11}},{"generated":{"line":33,"column":60},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":91,"column":4}},{"generated":{"line":33,"column":91},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":91,"column":35}},{"generated":{"line":33,"column":93},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":92,"column":4}},{"generated":{"line":33,"column":95},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":93,"column":3}},{"generated":{"line":33,"column":96},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":93,"column":4}},{"generated":{"line":33,"column":97},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":94,"column":4},"name":"replace"},{"generated":{"line":33,"column":104},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":94,"column":11}},{"generated":{"line":33,"column":105},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":95,"column":4}},{"generated":{"line":33,"column":131},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":95,"column":30}},{"generated":{"line":33,"column":133},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":96,"column":4}},{"generated":{"line":33,"column":135},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":97,"column":3}},{"generated":{"line":33,"column":136},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":97,"column":4}},{"generated":{"line":34,"column":2},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":99,"column":1},"name":"fragmentShader"},{"generated":{"line":34,"column":16},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":99,"column":15}},{"generated":{"line":34,"column":18},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":2},"name":"ShaderLib"},{"generated":{"line":34,"column":34},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":11}},{"generated":{"line":34,"column":35},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":12},"name":"phong"},{"generated":{"line":34,"column":40},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":17}},{"generated":{"line":34,"column":41},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":18},"name":"fragmentShader"},{"generated":{"line":34,"column":55},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":100,"column":32}},{"generated":{"line":34,"column":56},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":101,"column":4},"name":"replace"},{"generated":{"line":34,"column":63},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":101,"column":11}},{"generated":{"line":34,"column":64},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":102,"column":4}},{"generated":{"line":34,"column":83},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":102,"column":23}},{"generated":{"line":34,"column":214},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":110,"column":3}},{"generated":{"line":34,"column":215},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":110,"column":4}},{"generated":{"line":34,"column":216},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":111,"column":4},"name":"replace"},{"generated":{"line":34,"column":223},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":111,"column":11}},{"generated":{"line":34,"column":224},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":112,"column":4}},{"generated":{"line":34,"column":264},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":112,"column":44}},{"generated":{"line":34,"column":326},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":116,"column":3}},{"generated":{"line":34,"column":327},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":116,"column":4}},{"generated":{"line":34,"column":328},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":117,"column":4},"name":"replace"},{"generated":{"line":34,"column":335},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":117,"column":11}},{"generated":{"line":34,"column":336},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":118,"column":4}},{"generated":{"line":34,"column":369},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":118,"column":37}},{"generated":{"line":34,"column":371},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":119,"column":4}},{"generated":{"line":34,"column":373},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":120,"column":3}},{"generated":{"line":34,"column":374},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":120,"column":4}},{"generated":{"line":34,"column":375},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":121,"column":4},"name":"replace"},{"generated":{"line":34,"column":382},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":121,"column":11}},{"generated":{"line":34,"column":383},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":122,"column":4}},{"generated":{"line":34,"column":422},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":122,"column":43}},{"generated":{"line":34,"column":424},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":123,"column":4},"name":"lights_mmd_toon_pars_fragment"},{"generated":{"line":34,"column":453},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":124,"column":3}},{"generated":{"line":34,"column":454},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":124,"column":4}},{"generated":{"line":34,"column":455},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":125,"column":4},"name":"replace"},{"generated":{"line":34,"column":462},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":125,"column":11}},{"generated":{"line":34,"column":463},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":126,"column":4}},{"generated":{"line":34,"column":491},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":126,"column":32}},{"generated":{"line":34,"column":508},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":126,"column":32},"name":"concat"},{"generated":{"line":34,"column":514},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":126,"column":32}},{"generated":{"line":34,"column":515},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":128,"column":7},"name":"mmd_toon_matcap_fragment"},{"generated":{"line":34,"column":539},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":128,"column":31}},{"generated":{"line":34,"column":554},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":130,"column":3}},{"generated":{"line":35,"column":0},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":132,"column":0}},{"generated":{"line":35,"column":1},"source":"../node_modules/three/examples/jsm/shaders/MMDToonShader.js","original":{"line":132,"column":1}}],"sources":{"../node_modules/three/examples/jsm/shaders/MMDToonShader.js":"/**\n * MMD Toon Shader\n *\n * This shader is extended from MeshPhongMaterial, and merged algorithms with\n * MeshToonMaterial and MeshMetcapMaterial.\n * Ideas came from https://github.com/mrdoob/three.js/issues/19609\n *\n * Combining steps:\n *  * Declare matcap uniform.\n *  * Add gradientmap_pars_fragment.\n *  * Use gradient irradiances instead of dotNL irradiance from MeshPhongMaterial.\n *    (Replace lights_phong_pars_fragment with lights_mmd_toon_pars_fragment)\n *  * Add mmd_toon_matcap_fragment.\n */\n\nimport { UniformsUtils, ShaderLib } from 'three';\n\nconst lights_mmd_toon_pars_fragment = /* glsl */`\nvarying vec3 vViewPosition;\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n`;\n\nconst mmd_toon_matcap_fragment = /* glsl */`\n#ifdef USE_MATCAP\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\tvec4 matcapColor = texture2D( matcap, uv );\n\n\t#ifdef MATCAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight *= matcapColor.rgb;\n\n\t#elif defined( MATCAP_BLENDING_ADD )\n\n\t\toutgoingLight += matcapColor.rgb;\n\n\t#endif\n\n#endif\n`;\n\nconst MMDToonShader = {\n\n\tname: 'MMDToonShader',\n\n\tdefines: {\n\t\tTOON: true,\n\t\tMATCAP: true,\n\t\tMATCAP_BLENDING_ADD: true,\n\t},\n\n\tuniforms: UniformsUtils.merge( [\n\t\tShaderLib.toon.uniforms,\n\t\tShaderLib.phong.uniforms,\n\t\tShaderLib.matcap.uniforms,\n\t] ),\n\n\tvertexShader:\n\t\tShaderLib.phong.vertexShader\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_pars_vertex>',\n\t\t\t\t''\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_vertex>',\n\t\t\t\t''\n\t\t\t),\n\n\tfragmentShader:\n\t\tShaderLib.phong.fragmentShader\n\t\t\t.replace(\n\t\t\t\t'#include <common>',\n\t\t\t\t`\n\t\t\t\t\t#ifdef USE_MATCAP\n\t\t\t\t\t\tuniform sampler2D matcap;\n\t\t\t\t\t#endif\n\n\t\t\t\t\t#include <common>\n\t\t\t\t`\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_common_pars_fragment>',\n\t\t\t\t`\n\t\t\t\t\t#include <gradientmap_pars_fragment>\n\t\t\t\t`\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_pars_fragment>',\n\t\t\t\t''\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <lights_phong_pars_fragment>',\n\t\t\t\tlights_mmd_toon_pars_fragment\n\t\t\t)\n\t\t\t.replace(\n\t\t\t\t'#include <envmap_fragment>',\n\t\t\t\t`\n\t\t\t\t\t${mmd_toon_matcap_fragment}\n\t\t\t\t`\n\t\t\t)\n\n};\n\nexport { MMDToonShader };\n"},"lineCount":null}},"error":null,"hash":"99d11e8f3a156aed15bffbf87bb610e0","cacheData":{"env":{}}}